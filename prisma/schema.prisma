generator client {
  provider = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider  = "mysql"
  url       = env("DATABASE_URL")
  //directUrl = env("DIRECT_URL")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
// This is your updated User model.
// ใช้ Int แทน BigInt สำหรับ Dev/Local MySQL
model User {
  id                  Int      @id @default(autoincrement())
  name                String
  email               String   @unique
  password            String
  role                String   @default("member")
  created_at DateTime  @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)

  // Defines a one-to-many relationship: a user can have many files.
  files UserFile[]
}

model UserFile {
  id               Int @id @default(autoincrement())
  originalFileName String
  storagePath      String
  fileExtension    String

  created_at DateTime  @default(now()) @db.Timestamp(6)
  updated_at DateTime? @default(now()) @db.Timestamp(6)

  // Foreign key linking to the User model, now Int for local MySQL
  userId Int

  // Defines the many-to-one relationship: many files belong to one user.
  user User @relation(fields: [userId], references: [id])
}
